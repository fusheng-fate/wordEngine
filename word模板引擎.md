# wordæ¨¡æ¿å¼•æ“

å¸‚é¢ä¸Šå¸¸è§çš„å¼€æºçš„wordæ¨¡æ¿å¼•æ“ä¸»è¦æœ‰ä»¥ä¸‹å‡ ç§: **Apache POI**ã€**Freemarker**ã€**OpenOffice**ã€**Poi-tl**ã€**docx4j**ã€**spire.doc for java**ã€‚

| æ–¹æ¡ˆ               | ç§»æ¤æ€§           | åŠŸèƒ½æ€§                                                  | æ˜“ç”¨æ€§                                                       |
| ------------------ | ---------------- | ------------------------------------------------------- | ------------------------------------------------------------ |
| Apache POI         | Javaè·¨å¹³å°       | Apacheé¡¹ç›®ï¼Œå°è£…äº†å¸¸è§çš„æ–‡æ¡£æ“ä½œï¼Œä¹Ÿå¯ä»¥æ“ä½œåº•å±‚XMLç»“æ„ | æ–‡æ¡£ä¸å…¨ï¼Œå¼€å‘éš¾åº¦å¤§ï¼Œæœ€ç»ˆç”Ÿæˆæ•ˆæœä¸å¥½                       |
| Freemarker         | XMLè·¨å¹³å°        | ä»…æ”¯æŒæ–‡æœ¬ï¼Œæœ‰å±€é™æ€§                                    | ä¸æ¨èï¼ŒXMLç»“æ„çš„ä»£ç å‡ ä¹æ— æ³•ç»´æŠ¤                            |
| OpenOffice         | éœ€éƒ¨ç½²OpenOffice |                                                         | éœ€è¦äº†è§£OpenOfficeçš„API                                      |
| **Poi-tl**         | **Javaè·¨å¹³å°**   | **Wordæ¨¡æ¿å¼•æ“ï¼ŒåŸºäºApache POIï¼Œæä¾›æ›´å‹å¥½çš„API**       | **ä½ä»£ç ï¼Œæ–‡æ¡£æ˜“è¯»æ€§é«˜ï¼Œå¼€å‘ç®€å•ï¼Œç¤¾åŒºæ´»è·ƒï¼Œæ›´æ–°è¿­ä»£æ¯”è¾ƒå¿«** |
| docx4j             | ä¾èµ–office       | wordæ¨¡æ¿å¼•æ“                                            | ç”Ÿæˆæ•ˆæœä¸å¥½,å¼€å‘éš¾åº¦å¤§                                      |
| spire.doc for java | javaè·¨å¹³å°       | wordæ¨¡æ¿å¼•æ“ï¼Œwordè½¬pdf                                 | å¼€æºç‰ˆæœ¬æœ‰å±€é™æ€§                                             |



<hr><span style = "color:blue">ç»¼ä¸Šå¯¹æ¯”ä¹‹ä¸‹ï¼Œæ¨èä½¿ç”¨Poi-tl</span>

## Poi-tl

### Licence

Apache License 2.0

### ç‰ˆæœ¬å¯¹åº”å…³ç³»

| Poi-tl | Apache POI | java     |
| ------ | ---------- | -------- |
| 1.12.1 | 5.2.2+     | jdk 1.8+ |

### Maven

```xml
<dependency>
  <groupId>com.deepoove</groupId>
  <artifactId>poi-tl</artifactId>
  <version>1.12.1</version>
</dependency>
```

> NOTE: poi-tl `1.12.x` requires POI version `5.2.2+`.

## æ ‡ç­¾
æ ‡ç­¾ç”±ä¸¤ä¸ªèŠ±æ‹¬å·ç»„æˆï¼Œ' {{title}} 'æ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼Œ{{?Title}} ä¹Ÿæ˜¯ä¸€ä¸ªæ ‡ç­¾ï¼ŒTitleæ˜¯æ ‡ç­¾çš„åç§°ï¼Œ'?'æ ‡è¯†æ ‡ç­¾çš„ç±»å‹ã€‚æ¥ä¸‹æ¥ï¼Œè®©æˆ‘ä»¬çœ‹çœ‹æœ‰å“ªäº›æ ‡è®°ç±»å‹ã€‚

### æ–‡æœ¬æ ‡ç­¾
æ–‡æœ¬æ ‡ç­¾æ˜¯Wordæ¨¡æ¿ä¸­æœ€åŸºæœ¬çš„æ ‡ç­¾ç±»å‹ã€‚{{name}} å°†è¢«æ•°æ®æ¨¡å‹ä¸­é”® 'name' çš„å€¼æ‰€æ›¿æ¢ã€‚å¦‚æœé”®ä¸å­˜åœ¨ï¼Œæ ‡è®°å°†è¢«æ¸…é™¤(ç¨‹åºå¯ä»¥é…ç½®æ˜¯ä¿ç•™æ ‡è®°è¿˜æ˜¯æŠ›å‡ºå¼‚å¸¸)ã€‚æ–‡æœ¬æ ‡è®°çš„æ ·å¼å°†åº”ç”¨äºè¢«æ›¿æ¢çš„æ–‡æœ¬ï¼Œå¦‚ä¸‹é¢çš„ç¤ºä¾‹æ‰€ç¤ºã€‚


### å›¾ç‰‡æ ‡ç­¾
å›¾åƒæ ‡ç­¾ä»¥`@`å¼€å¤´ï¼Œä¾‹å¦‚ï¼Œâ€œ{{@logo}}â€å°†åœ¨æ•°æ®æ¨¡å‹ä¸­æŸ¥æ‰¾é”®ä¸ºâ€œlogoâ€çš„å€¼ï¼Œç„¶åå°†æ ‡ç­¾æ›¿æ¢ä¸ºå›¾åƒã€‚ä¸å›¾åƒæ ‡è®°ç›¸å¯¹åº”çš„æ•°æ®å¯ä»¥æ˜¯ç®€å•çš„URLæˆ–Pathå­—ç¬¦ä¸²ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒ…å«å›¾åƒå®½åº¦å’Œé«˜åº¦çš„ç»“æ„ã€‚

Code:

```java
// è®¾ç½®å›¾ç‰‡å®½é«˜
put("image1", Pictures.ofLocal("logo.png").size(120, 120).create());
```

Template:

```java
{{@logo}}
```

### è¡¨æ ¼æ ‡ç­¾
è¡¨æ ¼æ ‡ç­¾æ˜¯ä»¥ `#`å¼€å¤´, such as `{{#table}}`, å®ƒå°†å‘ˆç°ä¸ºä¸€ä¸ªæœ‰Nè¡ŒNåˆ—çš„Wordè¡¨ã€‚Nçš„å€¼å–å†³äºâ€œtableâ€æ ‡ç­¾çš„æ•°æ®ã€‚

Code:

```java
put("table", Tables.of(new String[][] {
                new String[] { "Song name", "Artist" }
            }).border(BorderStyle.DEFAULT).create());
```

Template:

```
{{#table}}
```

### åˆ—è¡¨æ ‡ç­¾
åˆ—è¡¨æ ‡ç­¾å¯¹åº”äºWordçš„ç¬¦å·åˆ—è¡¨æˆ–ç¼–å·åˆ—è¡¨ï¼Œä»¥`*`å¼€å¤´ï¼Œä¾‹å¦‚`{{*number}}`ã€‚

Code:
```java
put("list", Numberings.create("Plug-in grammar",
                  "Supports word text, pictures, table...",
                  "Template, not just template, but also style template"));
```

Template:

```
{{*list}}
```

Output:

```
â— Plug-in grammar
â— Supports word text, pictures, table...
â— Templates, not just templates, but also style templates
```

### åŒºå—æ ‡ç­¾
ä¸€ä¸ªåŒºå—å¯¹ç”±å‰åä¸¤ä¸ªæ ‡ç­¾ç»„æˆï¼Œæ ‡ç­¾ç”±`?`å¼€å¤´ï¼Œç»“æŸæ ‡è®°ç”¨`/`æ ‡è¯†ï¼Œä¾‹å¦‚`{{?Section}}` ä½œä¸ºsectionså—çš„å¼€å§‹æ ‡ç­¾ï¼Œ`{{/ Section}}`æ˜¯ç»“æŸæ ‡ç­¾ï¼Œ`Section`æ˜¯è¿™ä¸ªSectionçš„åç§°ã€‚
åŒºæ®µåœ¨å¤„ç†ä¸€ç³»åˆ—æ–‡æ¡£å…ƒç´ æ—¶éå¸¸æœ‰ç”¨ã€‚sectionä¸­çš„æ–‡æ¡£å…ƒç´ (æ–‡æœ¬ã€å›¾ç‰‡ã€è¡¨æ ¼ç­‰)å¯ä»¥å‘ˆç°0æ¬¡ã€1æ¬¡æˆ–Næ¬¡ï¼Œå…·ä½“å–å†³äºsectionçš„å€¼ã€‚

#### Falseæˆ–è€…ç©ºé›†åˆ
å¦‚æœåŒºå—å¯¹çš„å€¼æ˜¯ null ã€false æˆ–è€…ç©ºçš„é›†åˆï¼Œä½äºåŒºå—ä¸­çš„æ‰€æœ‰æ–‡æ¡£å…ƒç´ å°†ä¸ä¼šæ˜¾ç¤ºï¼Œè¿™å°±ç­‰åŒäºifè¯­å¥çš„æ¡ä»¶ä¸º falseã€‚


data-model:
```json
{
  "announce": false
}
```

Template:

```
Made it,Ma!{{?announce}}Top of the world!{{/announce}}
Made it,Ma!
{{?announce}}
Top of the world!ğŸ‹
{{/announce}}
```

Output:

```
Made it,Ma!
Made it,Ma!
```
#### éFalseä¸”ä¸æ˜¯é›†åˆ

å¦‚æœåŒºå—å¯¹çš„å€¼ä¸ä¸º null ã€ false ï¼Œä¸”ä¸æ˜¯é›†åˆï¼Œä½äºåŒºå—ä¸­çš„æ‰€æœ‰æ–‡æ¡£å…ƒç´ ä¼šè¢«æ¸²æŸ“ä¸€æ¬¡ï¼Œè¿™å°±ç­‰åŒäºifè¯­å¥çš„æ¡ä»¶ä¸º trueã€‚

data-model
```java
{
  "person": { "name": "Sayi" }
}
```
Template
```java
template.docx
{{?person}}

Hi {{name}}!

{{/person}}
```

Output:

```java
output.docx
Hi Sayi!
```

#### éç©ºé›†åˆ
å¦‚æœåŒºå—å¯¹çš„å€¼æ˜¯ä¸€ä¸ªéç©ºé›†åˆï¼ŒåŒºå—ä¸­çš„æ–‡æ¡£å…ƒç´ ä¼šè¢«è¿­ä»£æ¸²æŸ“ä¸€æ¬¡æˆ–è€…Næ¬¡ï¼Œè¿™å–å†³äºé›†åˆçš„å¤§å°ï¼Œç±»ä¼¼äºforeachè¯­æ³•ã€‚

data-model

```java
{
  "songs": [
    { "name": "Memories" },
    { "name": "Sugar" },
    { "name": "Last Dance" }
  ]
}
```

Template
```java
template.docx
{{?songs}}

{{name}}

{{/songs}}
```
Output

```java
output.docx
Memories

Sugar

Last Dance
```

### å¼•ç”¨æ ‡ç­¾

å¼•ç”¨æ ‡ç­¾æ˜¯ä¸€ç§ç‰¹æ®Šä½ç½®çš„ç‰¹æ®Šæ ‡ç­¾ï¼Œæä¾›äº†ç›´æ¥å¼•ç”¨æ–‡æ¡£ä¸­çš„å…ƒç´ å¥æŸ„çš„èƒ½åŠ›ï¼Œè¿™ä¸ªé‡è¦çš„ç‰¹æ€§åœ¨æˆ‘ä»¬åªæƒ³æ”¹å˜æ–‡æ¡£ä¸­æŸä¸ªå…ƒç´ æå°ä¸€éƒ¨åˆ†æ ·å¼å’Œå±æ€§çš„æ—¶å€™ç‰¹åˆ«æœ‰ç”¨ï¼Œå› ä¸ºå…¶ä½™æ ·å¼å’Œå±æ€§éƒ½å¯ä»¥åœ¨æ¨¡æ¿ä¸­é¢„ç½®å¥½ï¼ŒçœŸæ­£çš„æ‰€è§å³æ‰€å¾—ã€‚

å¼•ç”¨æ ‡ç­¾æ˜¯æŒ‡å¯ä»¥å°†å¼•ç”¨å¯¹è±¡ å…ƒç´ æ›¿æ¢ï¼Œä½†æ˜¯ä¿ç•™è¢«æ›¿æ¢å…ƒç´ çš„æ ¼å¼ã€‚

### å›¾è¡¨

å›¾è¡¨ï¼Œæˆ‘ä»¬ä½¿ç”¨è¿‡aspose word, æ‰€ä»¥è¿™é‡Œç®€å•å¯¹æ¯”ä¸€ä¸‹ï¼Œç›¸è¾ƒäºaspose wordæ¥è¯´ï¼Œä½¿ç”¨poi-tlä¸éœ€è¦æ ¹æ®ç”»å›¾è¡¨ï¼Œè€Œæ˜¯æ ¹æ®æ¨¡æ¿ä¸­çš„é¢„è®¾å›¾è¡¨è¿›è¡Œæ›¿æ¢ï¼Œä¸ä¼šæ”¹å˜æ¨¡æ¿ä¸­é¢„è®¾å›¾è¡¨çš„ç»“æ„ã€‚
ç›¸å¯¹è€Œè¨€ï¼Œä»£ç å˜çš„æ›´åŠ ç®€å•äº†ã€‚(ç®€æ˜“demoå‚ç…§ test/example/ChartExample)  ChartSingleSeriesRenderData(å•ç³»åˆ—å›¾è¡¨)  ChartMultiSeriesRenderData(å¤šç³»åˆ—å›¾è¡¨)

#### é¥¼å›¾
Charts.ofPie

#### æ¡å½¢å›¾

Charts.ofArea  Charts.ofBar

#### æŸ±å½¢å›¾

Charts.ofArea  Charts.ofBar

#### æŠ˜çº¿å›¾

Charts.ofArea  Charts.ofBar


### é…ç½®

#### spring elè¡¨è¾¾å¼

https://docs.spring.io/spring-framework/docs/5.3.18/reference/html/core.html#expressions


















